<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT資產管理 - 管理頁</title>
    <link rel="stylesheet" href="manage.css">
    <link rel="icon" type="image/png" href="logo.png">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
</head>
<body>
    <div class="manage-container">
        <aside class="sidebar">
            <h2 style="font-size:1.1em;">功能選單</h2>
            <ul class="sidebar-list">
                <li><button class="tab-btn" id="tab-asset" data-tab="asset">資產管理</button></li>
                <li><button class="tab-btn" id="tab-type" data-tab="type">類型管理</button></li>
                <li><button class="tab-btn" id="tab-type-detail" data-tab="type-detail">類型詳細</button></li>
                <li><button class="tab-btn" id="tab-user" data-tab="user">帳號管理</button></li>
                <li><button class="tab-btn" id="tab-role" data-tab="role">角色管理</button></li>
            </ul>
        </aside>
        <main class="main-content">
            <div class="top-bar">
                <h1 id="home-link" style="cursor:pointer;">IT資產管理 - 管理頁</h1>
                <button id="logout-btn">登出</button>
            </div>
            <section id="tab-content-asset">
                <h2>資產管理</h2>
                <section id="asset-form-section">
                    <h3>新增資產</h3>
                    <form id="asset-form">
                        <input type="text" id="name" placeholder="資產名稱" required>
                        <select id="type" required>
                            <option value="">請選擇資產類型</option>
                        </select>
                        <input type="text" id="owner" placeholder="用途" required>
                        <input type="text" id="location" placeholder="位置" required>
                        <button type="submit">新增</button>
                    </form>
                </section>
                <section id="asset-list-section">
                    <div style="margin-bottom:8px;">
                        <h3 style="margin:0;">資產清單</h3>
                        <div style="display:flex; align-items:center; justify-content:space-between; margin-top:8px;">
                            <button id="open-sort-modal-btn">排序功能</button>
                            <div style="flex:1"></div>
                            <select id="asset-type-filter-select" style="min-width:120px;"><option value="">全部類型</option></select>
                        </div>
                    </div>
                    <table id="asset-table">
                        <thead>
                            <tr>
                                <th>順序</th>
                                <th>名稱</th>
                                <th>類型</th>
                                <th>用途</th>
                                <th>位置</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- 資產資料將由JS動態插入 -->
                        </tbody>
                    </table>
                </section>
                
                <!-- 編輯資產 Modal -->
                <div id="edit-asset-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.35); z-index:1000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; padding:0; border-radius:10px; width:440px; max-height:70vh; position:relative; box-shadow:0 6px 24px rgba(0,0,0,0.13);">
                        <!-- 標題欄 -->
                        <div style="background:#f5f6fa; padding:18px 22px; border-bottom:1px solid #e5e7eb; border-radius:10px 10px 0 0;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <h3 style="margin:0; font-size:1.15em; font-weight:600; color:#222;">編輯資產</h3>
                                <button onclick="closeEditAssetModal()" style="background:none; border:none; color:#888; font-size:18px; cursor:pointer; padding:4px; width:28px; height:28px; border-radius:4px; transition:background 0.2s;" onmouseover="this.style.background='#ececec'" onmouseout="this.style.background='none'">×</button>
                            </div>
                        </div>
                        
                        <!-- 內容區域 -->
                        <div style="padding:22px 22px 18px 22px; overflow-y:auto; max-height:calc(70vh - 120px);">
                            <form id="edit-asset-form">
                                <input type="hidden" id="edit-asset-id">
                                <!-- 上半部：基本欄位 -->
                                <div style="margin-bottom:20px; padding-bottom:14px; border-bottom:1px solid #f0f1f3;">
                                    <h4 style="margin:0 0 14px 0; color:#444; font-size:1em; font-weight:600;">基本資訊</h4>
                                    <div style="display:flex; flex-direction:column; gap:13px;">
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">資產名稱</label>
                                            <input type="text" id="edit-asset-name" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">資產類型</label>
                                            <select id="edit-asset-type" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                                <option value="">請選擇資產類型</option>
                                            </select>
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">用途</label>
                                            <input type="text" id="edit-asset-owner" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">位置</label>
                                            <input type="text" id="edit-asset-location" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                    </div>
                                </div>
                                <!-- 下半部：自訂規格 -->
                                <div id="edit-asset-custom-fields-section" style="display:none; margin-bottom:20px; padding-bottom:14px; border-bottom:1px solid #f0f1f3;">
                                    <h4 style="margin:0 0 14px 0; color:#444; font-size:1em; font-weight:600;">自訂規格</h4>
                                    <div id="edit-asset-custom-fields-list">
                                        <!-- 自訂規格將在這裡動態顯示 -->
                                    </div>
                                </div>
                            </form>
                        </div>
                        <!-- 按鈕區域 - 絕對定位在底部 -->
                        <div style="position:absolute; bottom:0; left:0; right:0; background:#f5f6fa; padding:14px 22px; border-top:1px solid #e5e7eb; border-radius:0 0 10px 10px; display:flex; justify-content:flex-end; gap:8px;">
                            <button type="button" onclick="closeEditAssetModal()" style="padding:7px 16px; background:white; color:#666; border:1px solid #d1d5db; border-radius:5px; font-size:14px; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#f0f1f3'; this.style.borderColor='#bfc4ca'" onmouseout="this.style.background='white'; this.style.borderColor='#d1d5db'">取消</button>
                            <button type="submit" form="edit-asset-form" style="padding:7px 20px; background:#409eff; color:white; border:1px solid #409eff; border-radius:5px; font-size:14px; font-weight:500; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#2176bd'; this.style.borderColor='#2176bd'" onmouseout="this.style.background='#409eff'; this.style.borderColor='#409eff'">確定</button>
                        </div>
                    </div>
                </div>
                
                <!-- 成功提示框 -->
                <div id="success-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1001;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px; border-radius:12px; min-width:300px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:20px;">
                            <div style="width:60px; height:60px; background:#4CAF50; border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:30px;">✓</span>
                            </div>
                            <h3 style="margin:0; color:#333; font-size:1.3em;">編輯成功</h3>
                        </div>
                        <button id="success-ok-btn" style="padding:10px 30px; background:#4CAF50; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定</button>
                    </div>
                </div>

                <!-- 資產刪除確認 Modal -->
                <div id="delete-asset-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px 36px 32px 36px; border-radius:12px; min-width:340px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:18px;">
                            <div style="width:54px; height:54px; background:#F44336; border-radius:50%; margin:0 auto 14px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:28px;">&#9888;</span>
                            </div>
                            <h3 style="margin:0; color:#F44336; font-size:1.2em;">確定要刪除此資產？</h3>
                        </div>
                        <div class="modal-actions" style="position:static; justify-content:center; gap:18px; margin-top:0;">
                            <button id="delete-asset-cancel-btn" type="button" style="margin-right:10px; padding:8px 24px; background:#eee; color:#333; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">取消</button>
                            <button id="delete-asset-confirm-btn" type="button" style="padding:8px 24px; background:#F44336; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定刪除</button>
                        </div>
                    </div>
                </div>

                <!-- 排序彈窗 -->
                <div id="sort-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:3000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:30px; border-radius:8px; min-width:400px; min-height:300px;">
                        <h3 style="margin-top:0;">拖曳調整資產順序</h3>
                        <ul id="sort-list" style="list-style:none; padding:0; margin:0 0 20px 0; max-height:300px; overflow:auto;"></ul>
                        <div style="text-align:right;">
                            <button id="sort-cancel-btn" type="button" style="margin-right:10px; padding:8px 24px; background:#eee; color:#333; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">取消</button>
                            <button id="sort-confirm-btn" type="button" style="padding:8px 24px; background:#4CAF50; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定</button>
                        </div>
                    </div>
                </div>
            </section>
            <section id="tab-content-user" style="display:none;">
                <h2>帳號管理</h2>
                <div id="user-add-section">
                    <form id="user-add-form">
                        <input type="text" id="add-username" placeholder="帳號" required autocomplete="off">
                        <input type="password" id="add-password" placeholder="密碼" required autocomplete="new-password">
                        <select id="add-role" required>
                            <option value="">請選擇角色</option>
                        </select>
                        <button type="submit">新增帳號</button>
                    </form>
                </div>
                <div id="user-list-section">
                    <!-- 帳號管理功能 -->
                </div>
                
                <!-- 修改帳號 Modal -->
                <div id="edit-user-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.35); z-index:1000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; padding:0; border-radius:10px; width:440px; max-height:70vh; position:relative; box-shadow:0 6px 24px rgba(0,0,0,0.13);">
                        <!-- 標題欄 -->
                        <div style="background:#f5f6fa; padding:18px 22px; border-bottom:1px solid #e5e7eb; border-radius:10px 10px 0 0;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <h3 style="margin:0; font-size:1.15em; font-weight:600; color:#222;">編輯帳號</h3>
                                <button onclick="closeEditModal()" style="background:none; border:none; color:#888; font-size:18px; cursor:pointer; padding:4px; width:28px; height:28px; border-radius:4px; transition:background 0.2s;" onmouseover="this.style.background='#ececec'" onmouseout="this.style.background='none'">×</button>
                            </div>
                        </div>
                        <!-- 內容區域 -->
                        <div style="padding:22px 22px 18px 22px; overflow-y:auto; max-height:calc(70vh - 120px);">
                            <form id="edit-user-form">
                                <input type="hidden" id="edit-user-id">
                                <div style="margin-bottom:20px; padding-bottom:14px; border-bottom:1px solid #f0f1f3;">
                                    <h4 style="margin:0 0 14px 0; color:#444; font-size:1em; font-weight:600;">帳號資訊</h4>
                                    <div style="display:flex; flex-direction:column; gap:13px;">
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">帳號</label>
                                            <span id="edit-username-display" style="flex:1; color:#333; font-size:14px;"></span>
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">權限</label>
                                            <select id="edit-role" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                                <option value="">請選擇角色</option>
                                            </select>
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">新密碼</label>
                                            <input type="password" id="edit-password" placeholder="留空表示不修改" autocomplete="new-password" style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">備註</label>
                                            <input type="text" id="edit-remark" placeholder="備註" style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-actions" style="display:flex; justify-content:flex-end; gap:8px; padding-top:6px;">
                                    <button type="button" onclick="closeEditModal()" style="padding:7px 16px; background:white; color:#666; border:1px solid #d1d5db; border-radius:5px; font-size:14px; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#f0f1f3'; this.style.borderColor='#bfc4ca'" onmouseout="this.style.background='white'; this.style.borderColor='#d1d5db'">取消</button>
                                    <button type="submit" form="edit-user-form" style="padding:7px 20px; background:#409eff; color:white; border:1px solid #409eff; border-radius:5px; font-size:14px; font-weight:500; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#2176bd'; this.style.borderColor='#2176bd'" onmouseout="this.style.background='#409eff'; this.style.borderColor='#409eff'">確定</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- 帳號編輯成功提示框 -->
                <div id="user-success-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1001;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px; border-radius:12px; min-width:300px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:20px;">
                            <div style="width:60px; height:60px; background:#4CAF50; border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:30px;">✓</span>
                            </div>
                            <h3 style="margin:0; color:#333; font-size:1.3em;">編輯成功</h3>
                        </div>
                        <button id="user-success-ok-btn" style="padding:10px 30px; background:#4CAF50; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定</button>
                    </div>
                </div>

                <!-- 帳號刪除確認 Modal -->
                <div id="delete-user-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px 36px 32px 36px; border-radius:12px; min-width:340px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:18px;">
                            <div style="width:54px; height:54px; background:#F44336; border-radius:50%; margin:0 auto 14px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:28px;">&#9888;</span>
                            </div>
                            <h3 style="margin:0; color:#F44336; font-size:1.2em;">確定要刪除此帳號？</h3>
                        </div>
                        <div class="modal-actions" style="position:static; justify-content:center; gap:18px; margin-top:0;">
                            <button id="delete-user-cancel-btn" type="button" style="margin-right:10px; padding:8px 24px; background:#eee; color:#333; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">取消</button>
                            <button id="delete-user-confirm-btn" type="button" style="padding:8px 24px; background:#F44336; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定刪除</button>
                        </div>
                    </div>
                </div>
            </section>
            <section id="tab-content-role" style="display:none;">
                <h2>角色管理</h2>
                <div id="role-add-section">
                    <h3>新增角色</h3>
                    <form id="role-add-form">
                        <input type="text" id="role-name" placeholder="角色名稱" required>
                        <button type="submit">新增角色</button>
                    </form>
                </div>
                <div id="role-list-section">
                    <h3>角色列表</h3>
                    <!-- 角色列表將由JS動態插入 -->
                </div>
                <!-- 編輯角色 Modal -->
                <div id="edit-role-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.35); z-index:1000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; padding:0; border-radius:10px; width:540px; max-width:96vw; max-height:80vh; position:relative; box-shadow:0 6px 24px rgba(0,0,0,0.13);">
                        <!-- 標題欄 -->
                        <div style="background:#f5f6fa; padding:18px 22px; border-bottom:1px solid #e5e7eb; border-radius:10px 10px 0 0;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <h3 style="margin:0; font-size:1.15em; font-weight:600; color:#222;">編輯角色</h3>
                                <button onclick="closeEditRoleModal()" style="background:none; border:none; color:#888; font-size:18px; cursor:pointer; padding:4px; width:28px; height:28px; border-radius:4px; transition:background 0.2s;" onmouseover="this.style.background='#ececec'" onmouseout="this.style.background='none'">×</button>
                            </div>
                        </div>
                        <!-- 內容區域 -->
                        <div style="padding:22px 22px 18px 22px; overflow-y:auto; max-height:calc(80vh - 120px);">
                            <form id="edit-role-form">
                                <input type="hidden" id="edit-role-id">
                                <div style="margin-bottom:20px; padding-bottom:14px; border-bottom:1px solid #f0f1f3;">
                                    <h4 style="margin:0 0 14px 0; color:#444; font-size:1em; font-weight:600;">角色資訊</h4>
                                    <div style="display:flex; flex-direction:column; gap:13px;">
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">角色名稱</label>
                                            <input type="text" id="edit-role-name" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">說明</label>
                                            <input type="text" id="edit-role-desc" style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">備註</label>
                                            <input type="text" id="edit-role-remark" style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-bottom:20px; padding-bottom:14px; border-bottom:1px solid #f0f1f3;">
                                    <h4 style="margin:0 0 14px 0; color:#444; font-size:1em; font-weight:600;">權限設定</h4>
                                    <div id="edit-role-perms"></div>
                                </div>
                                <div class="modal-actions" style="display:flex; justify-content:flex-end; gap:8px; padding-top:6px;">
                                    <button type="button" onclick="closeEditRoleModal()" style="padding:7px 16px; background:white; color:#666; border:1px solid #d1d5db; border-radius:5px; font-size:14px; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#f0f1f3'; this.style.borderColor='#bfc4ca'" onmouseout="this.style.background='white'; this.style.borderColor='#d1d5db'">取消</button>
                                    <button type="submit" form="edit-role-form" style="padding:7px 20px; background:#409eff; color:white; border:1px solid #409eff; border-radius:5px; font-size:14px; font-weight:500; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#2176bd'; this.style.borderColor='#2176bd'" onmouseout="this.style.background='#409eff'; this.style.borderColor='#409eff'">確定</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- 角色編輯成功提示框 -->
                <div id="role-success-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1001;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px; border-radius:12px; min-width:300px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:20px;">
                            <div style="width:60px; height:60px; background:#4CAF50; border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:30px;">✓</span>
                            </div>
                            <h3 style="margin:0; color:#333; font-size:1.3em;">編輯成功</h3>
                        </div>
                        <button id="role-success-ok-btn" style="padding:10px 30px; background:#4CAF50; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定</button>
                    </div>
                </div>

                <!-- 角色刪除確認 Modal -->
                <div id="delete-role-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px 36px 32px 36px; border-radius:12px; min-width:340px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:18px;">
                            <div style="width:54px; height:54px; background:#F44336; border-radius:50%; margin:0 auto 14px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:28px;">&#9888;</span>
                            </div>
                            <h3 style="margin:0; color:#F44336; font-size:1.2em;">確定要刪除此角色？</h3>
                        </div>
                        <div class="modal-actions" style="position:static; justify-content:center; gap:18px; margin-top:0;">
                            <button id="delete-role-cancel-btn" type="button" style="margin-right:10px; padding:8px 24px; background:#eee; color:#333; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">取消</button>
                            <button id="delete-role-confirm-btn" type="button" style="padding:8px 24px; background:#F44336; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定刪除</button>
                        </div>
                    </div>
                </div>
            </section>
            <section id="tab-content-type" style="display:none;">
                <h2>類型管理</h2>
                <div id="type-add-section">
                    <h3>新增類型</h3>
                    <form id="type-add-form">
                        <input type="text" id="type-name" placeholder="類型名稱" required>
                        <input type="text" id="type-description" placeholder="類型描述">
                        <button type="submit">新增類型</button>
                    </form>
                </div>
                <div id="type-list-section">
                    <h3>類型列表</h3>
                    <!-- 類型列表將由JS動態插入 -->
                </div>
                <!-- 編輯類型 Modal -->
                <div id="edit-type-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.35); z-index:1000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; padding:0; border-radius:10px; width:440px; max-height:70vh; position:relative; box-shadow:0 6px 24px rgba(0,0,0,0.13);">
                        <!-- 標題欄 -->
                        <div style="background:#f5f6fa; padding:18px 22px; border-bottom:1px solid #e5e7eb; border-radius:10px 10px 0 0;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <h3 style="margin:0; font-size:1.15em; font-weight:600; color:#222;">編輯類型</h3>
                                <button onclick="closeEditTypeModal()" style="background:none; border:none; color:#888; font-size:18px; cursor:pointer; padding:4px; width:28px; height:28px; border-radius:4px; transition:background 0.2s;" onmouseover="this.style.background='#ececec'" onmouseout="this.style.background='none'">×</button>
                            </div>
                        </div>
                        <!-- 內容區域 -->
                        <div style="padding:22px 22px 18px 22px; overflow-y:auto; max-height:calc(70vh - 120px);">
                            <form id="edit-type-form">
                                <input type="hidden" id="edit-type-id">
                                <div style="margin-bottom:20px; padding-bottom:14px; border-bottom:1px solid #f0f1f3;">
                                    <h4 style="margin:0 0 14px 0; color:#444; font-size:1em; font-weight:600;">類型資訊</h4>
                                    <div style="display:flex; flex-direction:column; gap:13px;">
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">類型名稱</label>
                                            <input type="text" id="edit-type-name" required style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                        <div style="display:flex; align-items:center; gap:12px;">
                                            <label style="min-width:74px; font-weight:500; color:#555; font-size:0.95em;">描述</label>
                                            <input type="text" id="edit-type-description" style="flex:1; padding:8px 10px; border:1px solid #d1d5db; border-radius:5px; font-size:14px; transition:border-color 0.2s; box-sizing:border-box; background:#fafbfc;" onfocus="this.style.borderColor='#409eff'" onblur="this.style.borderColor='#d1d5db'">
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-actions" style="display:flex; justify-content:flex-end; gap:8px; padding-top:6px;">
                                    <button type="button" onclick="closeEditTypeModal()" style="padding:7px 16px; background:white; color:#666; border:1px solid #d1d5db; border-radius:5px; font-size:14px; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#f0f1f3'; this.style.borderColor='#bfc4ca'" onmouseout="this.style.background='white'; this.style.borderColor='#d1d5db'">取消</button>
                                    <button type="submit" form="edit-type-form" style="padding:7px 20px; background:#409eff; color:white; border:1px solid #409eff; border-radius:5px; font-size:14px; font-weight:500; cursor:pointer; transition:background 0.2s, border-color 0.2s;" onmouseover="this.style.background='#2176bd'; this.style.borderColor='#2176bd'" onmouseout="this.style.background='#409eff'; this.style.borderColor='#409eff'">確定</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- 類型編輯成功提示框 -->
                <div id="type-success-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1001;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px; border-radius:12px; min-width:300px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:20px;">
                            <div style="width:60px; height:60px; background:#4CAF50; border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:30px;">✓</span>
                            </div>
                            <h3 style="margin:0; color:#333; font-size:1.3em;">編輯成功</h3>
                        </div>
                        <button id="type-success-ok-btn" style="padding:10px 30px; background:#4CAF50; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定</button>
                    </div>
                </div>

                <!-- 類型刪除確認 Modal -->
                <div id="delete-type-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:2000;">
                    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px 36px 32px 36px; border-radius:12px; min-width:340px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                        <div style="margin-bottom:18px;">
                            <div style="width:54px; height:54px; background:#F44336; border-radius:50%; margin:0 auto 14px; display:flex; align-items:center; justify-content:center;">
                                <span style="color:white; font-size:28px;">&#9888;</span>
                            </div>
                            <h3 style="margin:0; color:#F44336; font-size:1.2em;">確定要刪除此類型？</h3>
                        </div>
                        <div class="modal-actions" style="position:static; justify-content:center; gap:18px; margin-top:0;">
                            <button id="delete-type-cancel-btn" type="button" style="margin-right:10px; padding:8px 24px; background:#eee; color:#333; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">取消</button>
                            <button id="delete-type-confirm-btn" type="button" style="padding:8px 24px; background:#F44336; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定刪除</button>
                        </div>
                    </div>
                </div>
            </section>
            <section id="tab-content-type-detail" style="display:none;">
                <h2>類型詳細</h2>
                <div id="type-detail-section">
                    <h3>自訂欄位管理</h3>
                    <div style="margin-bottom:20px;">
                        <label style="display:block; margin-bottom:8px; font-weight:bold;">選擇資產類型：</label>
                        <select id="asset-type-setting-select" style="width:200px; padding:8px; border:1px solid #ccc; border-radius:4px;">
                            <option value="">請選擇資產類型</option>
                        </select>
                    </div>
                    
                    <div id="type-custom-fields-section" style="display:none;">
                        <div style="margin-bottom:15px;">
                            <h4 style="margin:0 0 10px 0;">自訂欄位列表</h4>
                            <div id="type-custom-fields-list" style="margin-bottom:15px;">
                                <!-- 自訂欄位將在這裡動態顯示 -->
                            </div>
                            <button id="add-type-custom-field-btn" type="button" style="padding:8px 16px; background:#4CAF50; color:white; border:none; border-radius:4px; cursor:pointer; margin-right:10px;">新增欄位</button>
                            <button id="type-custom-fields-save-btn" type="button" style="padding:8px 16px; background:#2196F3; color:white; border:none; border-radius:4px; cursor:pointer;">儲存設定</button>
                        </div>
                    </div>
                </div>
            </section>
            <div id="logout-confirm-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:4000;">
                <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:40px 36px 32px 36px; border-radius:12px; min-width:340px; text-align:center; box-shadow:0 4px 20px rgba(0,0,0,0.15);">
                    <div style="margin-bottom:18px;">
                        <div style="width:54px; height:54px; background:#FFA726; border-radius:50%; margin:0 auto 14px; display:flex; align-items:center; justify-content:center;">
                            <span style="color:white; font-size:28px;">&#9888;</span>
                        </div>
                        <h3 style="margin:0; color:#FFA726; font-size:1.2em;">確定要登出？</h3>
                    </div>
                    <div class="modal-actions" style="position:static; justify-content:center; gap:18px; margin-top:0;">
                        <button id="logout-cancel-btn" type="button" style="margin-right:10px; padding:8px 24px; background:#eee; color:#333; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">取消</button>
                        <button id="logout-confirm-btn" type="button" style="padding:8px 24px; background:#FFA726; color:white; border:none; border-radius:6px; font-size:1em; cursor:pointer; transition:background 0.2s;">確定登出</button>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="manage.js"></script>
</body>
</html> 